{% extends "products/main-product.html" %}

{% block content %}
<div class="container mt-4">
    <div class="card form-container">
        <div class="card-body">
            <!-- Search Section -->
            <div id="searchSection" class="search-section">
                <h2 class="card-title">Search Product</h2>
                <form method="POST" id="searchForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="search_product" class="sr-only">Product search</label>
                            <input type="text" class="form-control" id="search_product"
                                   name="search_account" placeholder="Search product..." autocomplete="off">
                            <!-- Hidden fields for all data -->
                            <input type="hidden" id="product_number" name="product_number">
                            <input type="hidden" id="product" name="product">
                            <input type="hidden" id="edition" name="edition">
                            <input type="hidden" id="isbn" name="isbn">
                            <input type="hidden" id="date" name="date">
                            <input type="hidden" id="publisher" name="publisher">
                            <input type="hidden" id="author" name="author">
                            <input type="hidden" id="date_created" name="date_created">
                            <input type="hidden" id="frequency" name="frequency">

                        </div>
                        <div class="button-group">
                            <button type="button" id="searchButton" class="btn btn-primary">Search</button>
                            <a href="{{ url_for('admin_dashboard') if session.get('role') == 2 else url_for('superuser_dashboard') }}" class="btn btn-secondary">Back to Main Menu</a>
                        </div>
                    </div>
                </form>
            </div>

            <!-- Results display area - will be populated dynamically -->
            <div id="productDetails" class="mt-4 hidden">
                <button type="button" id="backToSearch" class="btn btn-outline-secondary back-to-search">
                    &larr; Back to Search
                </button>
                <h4 id="productDetailsTitle">Product Details</h4>
                <div id="viewProductDetails" class="editable-form">
                    <table class="table table-bordered">
                        <tbody>
                            <tr>
                                <th>Product Number</th>
                                <td id="view-product_number"></td>
                            </tr>
                            <tr>
                                <th>Product</th>
                                <td id="view-product"></td>
                            </tr>
                            <tr>
                                <th>Edition</th>
                                <td id="view-edition"></td>
                            </tr>
                            <tr>
                                <th>ISBN</th>
                                <td id="view-isbn"></td>
                            </tr>
                            <tr>
                                <th>Date</th>
                                <td id="view-date"></td>
                            </tr>
                            <tr>
                                <th>Publisher</th>
                                <td id="view-publisher"></td>
                            </tr>
                            <tr>
                                <th>Author</th>
                                <td id="view-author"></td>
                            </tr>
                            <tr>
                                <th>Frequency</th>
                                <td id="view-frequency"></td>
                            </tr>
                        </tbody>
                    </table>
                    <div class="text-right mt-3">
                        <button type="button" id="editProductBtn" class="btn btn-primary">Edit Product</button>
                        <button type="button" id="deleteProductBtn" class="btn btn-primary">Delete Product</button>
<!--                        <button type="button" id="addBillingAcc" class="btn btn-primary">Add New Account</button>-->
                    </div>
                </div>
                {% include "products/edit-product.html" %}
            </div>
        </div>
    </div>
</div>

<!-- Include results popup -->
{% include "products/results.html" %}


{% block extra_js %}
<script > var searchUrl = "{{ url_for('products') }}";</script>
<script src="{{ url_for('static', filename='js/products.js') }}"></script>
{% endblock %}
{% endblock %}